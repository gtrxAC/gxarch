; arg0 = x
; arg1 = ch
; arg2 = y
; return value arg3 arg4
; uses regs arg5 arg6
pos2addr: {
	reg x arg0
	reg ch arg1
	reg y arg2

	reg resh arg3
	reg resl arg4

	reg ch_tmp arg5
	reg y_tmp arg6

	set resh hi(track)
	set resl lo(track)

	mul y (%0:TRACK_LENGTH) y_tmp
	add resh %h resh
	add resl y_tmp resl

	mul ch (%0:CHANNEL_LENGTH) ch_tmp
	add resh %h resh
	add resl ch_tmp resl

	add resl x resl
	add resh %h resh
	ret
}